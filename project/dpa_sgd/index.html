<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Zijian Hu">

  
  
  
    
  
  <meta name="description" content="We designed a decentralized multi-task learning framework and a novel optimization algorithm to collaboratively train models over distributed devices by only sharing their gradient periodically">

  
  <link rel="alternate" hreflang="en-us" href="https://www.zijianhu.com/project/dpa_sgd/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="rgba(183, 50, 50, 1)">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  




  

  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hub8aaec6c2c2e1082c2b24756ea87d425_171065_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hub8aaec6c2c2e1082c2b24756ea87d425_171065_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.zijianhu.com/project/dpa_sgd/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@zijianhu">
  <meta property="twitter:creator" content="@zijianhu">
  
  <meta property="og:site_name" content="Zijian Hu">
  <meta property="og:url" content="https://www.zijianhu.com/project/dpa_sgd/">
  <meta property="og:title" content="Decentralized Federated Multi-Task Learning and System Design | Zijian Hu">
  <meta property="og:description" content="We designed a decentralized multi-task learning framework and a novel optimization algorithm to collaboratively train models over distributed devices by only sharing their gradient periodically"><meta property="og:image" content="https://www.zijianhu.com/project/dpa_sgd/featured.png">
  <meta property="twitter:image" content="https://www.zijianhu.com/project/dpa_sgd/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-03T00:00:00-08:00">
    
    <meta property="article:modified_time" content="2019-05-03T00:00:00-08:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.zijianhu.com/project/dpa_sgd/"
  },
  "headline": "Decentralized Federated Multi-Task Learning and System Design",
  
  "image": [
    "https://www.zijianhu.com/project/dpa_sgd/featured.png"
  ],
  
  "datePublished": "2019-05-03T00:00:00-08:00",
  "dateModified": "2019-05-03T00:00:00-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Chaoyang He"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Zijian Hu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.zijianhu.com/images/icon_hub8aaec6c2c2e1082c2b24756ea87d425_171065_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "We designed a decentralized multi-task learning framework and a novel optimization algorithm to collaboratively train models over distributed devices by only sharing their gradient periodically"
}
</script>

  

  


  


  





  <title>Decentralized Federated Multi-Task Learning and System Design | Zijian Hu</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  <script src="/js/wowchemy-init.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Zijian Hu</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Zijian Hu</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://drive.google.com/file/d/1oAOGkY2FmW6SOBPwkvSkb-ANSilb6Smv/view?usp=sharing" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article article-project">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Decentralized Federated Multi-Task Learning and System Design</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span ><a href="/author/chaoyang-he/">Chaoyang He</a></span>, <span ><a href="/author/tian-xie/">Tian Xie</a></span>, <span ><a href="/author/zhengyu-yang/">Zhengyu Yang</a></span>, <span class="author-highlighted"><a href="/author/zijian-hu/">Zijian Hu</a></span>, <span ><a href="/author/shuai-xia/">Shuai Xia</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    May 3, 2019
  </span>
  

  

  

  
  
  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 402px;">
  <div style="position: relative">
    <img src="/project/dpa_sgd/featured_hud36b395643187c01803940875ab28bd4_176770_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p><em><strong>This page contains a copy of the final report of our final project for Spring 2019 CSCI-599: Deep Learning and its Applications at the University of Southern California. The <a href="http://fl.chaoyanghe.com/" target="_blank" rel="noopener">original page</a> was removed</strong></em></p>
<h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li><a href="#problem-formulation">Problem formulation</a>
      <ul>
        <li><a href="#statistical-challenges">Statistical Challenges</a></li>
        <li><a href="#system-challenges">System Challenges</a></li>
        <li><a href="#general-definition-of-federated-learning">General Definition of Federated Learning</a></li>
        <li><a href="#general-framework-of-federated-multi-task-learning">General Framework of Federated Multi-Task Learning</a></li>
        <li><a href="#federated-multi-task-deep-learning-framework">Federated Multi-Task Deep Learning Framework</a></li>
      </ul>
    </li>
    <li><a href="#approach">Approach</a>
      <ul>
        <li><a href="#decentralized-periodic-averaging-sgd">Decentralized Periodic Averaging SGD</a></li>
        <li><a href="#algorithm">Algorithm</a></li>
        <li><a href="#advantages-of-our-algorithm">Advantages of Our Algorithm</a></li>
        <li><a href="#system-design">System Design</a></li>
      </ul>
    </li>
    <li><a href="#comparison-to-previous-works">Comparison to Previous Works</a>
      <ul>
        <li><a href="#federated-multi-task-learning">Federated Multi-Task Learning</a></li>
        <li><a href="#stochastic-gradient-decent-optimization">Stochastic Gradient Decent Optimization</a></li>
      </ul>
    </li>
    <li><a href="#results">Results</a></li>
    <li><a href="#appendix">Appendix</a>
      <ul>
        <li><a href="#appendix-i-convergence-analysis">Appendix I: Convergence Analysis</a></li>
        <li><a href="#appendix-ii-poster">Appendix II: Poster</a></li>
      </ul>
    </li>
  </ul>
</nav>
<p>In the cloud-based environment, distributed deep learning systems such as Tensorflow and PyTorch is widespread in various domains, but they are typically built based on the parameter server, which
requires data integrated into one place (a server or a cluster) to train a model[Dean <em>et al.</em>; Li <em>et al.</em>, 2014; Cui <em>et al.</em>, 2014; Abadi <em>et al.</em>, 2016; Paszke <em>et al.</em>, 2017], as shown in Figure 1(a). Increasing
practical constraints lead this data integration difficult or impossible, including data privacy and confidentiality, intellectual property protection, and law constraints. A promising solution to these
problems is called Federated Learning [McMahan <em>et al.</em>, 2016]. As shown in Figure 1(b), Federated Learning enables collaboratively training on edge devices or edge data centers through exchanging parameters or gradients without centralizing their scattered data (In this work, we use both worker and node to represent edge devices or edge data centers). Representative examples happen in various domains such as Mobile Internet, health, and finance domains [McMahan and Ramage, 2017, Liu <em>et al.</em>, 2018a, Liu <em>et al.</em>, 2018b].</p>






  



  
  











<figure id="figure-federated-multi-task-learning-topology-a-cloud-based-distributed-learning-b-centralized-federated-learning-c-decentralized-federated-learning-d-centralized-communication-topology-with-decentralized-parameter-exchanging-topology">


  <a data-fancybox="" href="/project/dpa_sgd/images/introduction_hu3ada94327916f25607af6cbc5bb02ef8_300845_2000x2000_fit_lanczos_2.png" data-caption="Federated Multi-Task Learning Topology. (a) Cloud-Based Distributed Learning; (b) Centralized Federated Learning; (c) Decentralized Federated Learning; (d) Centralized Communication Topology with Decentralized Parameter Exchanging Topology.">


  <img data-src="/project/dpa_sgd/images/introduction_hu3ada94327916f25607af6cbc5bb02ef8_300845_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="1775" height="1623">
</a>


  
  
  <figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
    Federated Multi-Task Learning Topology. (a) Cloud-Based Distributed Learning; (b) Centralized Federated Learning; (c) Decentralized Federated Learning; (d) Centralized Communication Topology with Decentralized Parameter Exchanging Topology.
  </figcaption>


</figure>

<h2 id="problem-formulation">Problem formulation</h2>
<h3 id="statistical-challenges">Statistical Challenges</h3>
<ol>
<li><strong>Non-IID</strong>: Each worker generates data in a non-i.i.d. (independent and identically distributed) manner with a distinct statistical distribution.</li>
<li><strong>Unbalanced Local Data</strong>: Workers have different quantity of data sample due to their different behaviors.</li>
</ol>
<p>These two characteristics bring challenges to learning a high-performance personalized model for each worker.</p>
<h3 id="system-challenges">System Challenges</h3>
<ol>
<li><strong>Larger Worker Number</strong>: The worker number is typically larger than cloudbased learning. The larger number will pose a higher communication cost and difficult communication
synchronization.</li>
<li><strong>Heterogeneous Networks</strong>: Each worker may differ in communication capacity due to heterogeneous networks(4G, WiFi, and other IoT protocol).</li>
<li><strong>Heterogeneous Computation</strong>: Computational
capacities of each worker may differ due to variability in hardware(CPU, memory).</li>
</ol>
<p>These three characteristics make communication cost and low-speed training become a major bottleneck towards real-world deployment.</p>
<p>In practice, scattered data owners also demand personalized models rather than a global model for all owners. They hope to not only get help from other owners’ data to train a high accuracy model but also to gain their personalized models which can represent their unique data properties. Thus, to simultaneously address statistical and system challenges is the primary research direction of federated learning.</p>






  



  
  











<figure id="figure-figure-2-federated-multi-task-deep-learning-framework">


  <a data-fancybox="" href="/project/dpa_sgd/images/decentralizedFramework_hu58784681c8646995d497d2752388e320_131151_2000x2000_fit_lanczos_2.png" data-caption="Figure 2: Federated Multi-Task Deep Learning Framework">


  <img data-src="/project/dpa_sgd/images/decentralizedFramework_hu58784681c8646995d497d2752388e320_131151_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="3006" height="1017">
</a>


  
  
  <figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
    Figure 2: Federated Multi-Task Deep Learning Framework
  </figcaption>


</figure>

<h3 id="general-definition-of-federated-learning">General Definition of Federated Learning</h3>
<p>Following the first federated learning paper McMahan <em>et al.</em> [2016], we define the objective function for the federated setting as</p>
<p>$$
\begin{aligned}
F(\mathbf{w}) &amp;= \sum_{k=1}^{K} \frac{n_k}{N} F_{k}(\mathbf{w}) \\<br>
&amp;= \sum_{k=1}^{K} \frac{n_k}{N} \frac{1}{n_k} \sum_{i \in \mathcal{P}_{k}} l(\mathbf{x}_{i}, \mathbf{y}_{i}; \mathbf{w})
\end{aligned}
$$</p>
<p>where $ l(\mathbf{x}_{i}, \mathbf{y}_{i}; \mathbf{w}) $ is the loss function of the prediction on example $(\mathbf{x}_{i}, \mathbf{y}_{i})$ made with model parameters $\mathbf{w}$, K is the total learning nodes number, $\mathcal{P}_{k}$ is the set of indexes of data points on node k, $n_k = |P_k|$, and $\sum_{k=1}^{K} n_{k} = N$. This objective function can capture the different quantity of samples and statistical distribution of K nodes. Here, different nodes learn the global model jointly, which showing as the same loss function $l$ and parameters $\mathbf{w}$.</p>
<h3 id="general-framework-of-federated-multi-task-learning">General Framework of Federated Multi-Task Learning</h3>
<p>As mentioned in the introduction, federated multi-task learning is a framework that can improve the performance by directly capturing the relationships among unbalanced data in multiple devices, which implies that it can address the statistical challenges in federated learning. The general formulation for federated multi-task learning is:</p>
<p>$$
\min_{\mathbf{W}}\sum_{k=1}^{K}\frac{1}{n_k}\sum_{i=1}^{n_k}l_i(\mathbf{x}_i,\mathbf{y}_i;\mathbf{w}_k) + \mathcal{R}(\mathbf{W},\mathbf{\Omega}).
$$</p>
<p>where $\mathbf{W} = (\mathbf{w}_1,\mathbf{w}_2,&hellip;,\mathbf{w}_K) \in \mathbb{R}^{d \times{m}}$ is the parameters for different tasks and $\mathcal{R}(\mathbf{W},\mathbf{\Omega})$ is the regularization. Different multi-task framework is mainly different from the regularization term $\mathcal{R}$.</p>
<p>The first term of the objective models the summation of different empirical loss of each node. The second term serves as a task-relationship regularizer with $\mathbf{\Omega}\in\mathbb{R}^{K\times{K}}$ being the covariance matrix Zhang and Yeung [2012].</p>
<p>The covariance matrix is able to describe positive, negative and unrelated correlation between nodes, which can either known as priori or being measured while learning the models simultaneously.</p>
<p>Each element $\mathbf{\Omega}_{i,j}$ is a value that indicates the similarity between two nodes. Here we use a bio-convex formulation in Zhang and Yeung [2012], which is a general case for other regularization methods,</p>
<p>$$
\mathcal{R}(\mathbf{W},\mathbf{\Omega}) = \lambda_ 1tr(\mathbf{W}\mathbf{\Omega}^{-1}\mathbf{W}^{T}) + \lambda_2||\mathbf{W}||_F^2.
$$</p>
<p>where we constrain $\vec{W}$ with covariance matrix $\mathbf{\Omega}^{-1}$ through matrix trace $tr(\mathbf{W}\mathbf{\Omega}^{-1}\mathbf{W}^{T})$. This means the closer $\mathbf{w}_i$ and $\mathbf{w}_j$ is, the larger the $\mathbf{\Omega}_{i,j}$ will be. Specifically if $\mathbf{\Omega}$ is an identity matrix, then each node is independent to each other.
Smith <em>et al.</em> [2017] proposed MOCHA based on the above multi-task learning framework. However, MOCHA can only handle convex functions in federated multi-task learning settings, which can not be generated to non-convex deep learning models. Our work generates federated multi-task learning framework to the non-convex DNN setting.</p>
<h3 id="federated-multi-task-deep-learning-framework">Federated Multi-Task Deep Learning Framework</h3>
<p>DNNs are able to extract deep features from raw data. However, to the best of our knowledge, DNNs has not been applied to federated multi-task problems. We thus consider DNNs as our feature transformation function and make prediction based on the hidden features. Formally speaking, the formulation can be defined as:</p>
<p>$$
\begin{aligned}
&amp; \begin{aligned} \min_{\mathbf{\theta}, \vec{U},\vec{W},\mathbf{\Omega}}
&amp;\sum_{k=1}^{K}\frac{1}{n_k}\bigg[\bigg.\sum_{i=1}^{n_k}l(f(\vec{x}_i^{k},\mathbf{\theta}_k,\vec{U}_k,\vec{w}_k),\vec{y}_i^k) \\<br>
&amp;+ \frac{1}{2}\lambda_ 1tr(\vec{W}_k\mathbf{\Omega}_k^{-1}\vec{W}_k^{T})\bigg]\bigg. + \frac{1}{2}\lambda_2||\vec{W}||_F^2\\<br>
&amp;+\frac{1}{2}\lambda_3||\mathbf{\theta}||_F^2 + \frac{1}{2}\lambda_4||\vec{U}||_F^2, \end{aligned} \\<br>
&amp; \quad \text{s.t.} \quad  \mathbf{\Omega}_k \ge 0 \quad \text{and} \quad tr(\mathbf{\Omega}_k) = 1, \quad k = 1, 2, &hellip; ,K.
\end{aligned}
$$</p>
<p>where $f(\cdot)$ represents DNNs feature mapping as shown in Figure 2(b). $\mathbf{\theta}_k$ is the feature transformation network. $\mathbf{U}_k$ and $\vec{w}_k$ are output layer (e.g. softmax). The first constraint holds due to the fact that $\mathbf{\Omega}$ is defined as a task covariance matrix. The second constraint is used to restrict its complexity.</p>
<p>In federated learning situation, training should be conducted on each node respectively. One intuitive thought is the centralized network topology in McMahan <em>et al.</em> [2016], where one center node synchronously takes a weighted average parameters of every clients at each time step (Figure 2(a)). However,  this model faces the problems that in DNNs situation, far more parameters need to be calculated and transferred. Each node has heterogeneous computing performance and network bandwidth (Figure (b)). Setting one center node to synchronously collect all the parameters will induce high communication cost and low convergence speed. In order to overcome these problems, we design a decentralized topology, where each node only needs to share their parameters with neighbored nodes as shown in Figure 2(c)), where there is no communication between worker one and worker 4. Abandoning the central node induces the problem that parameters cannot be exchanged and synchronized amongst every nodes, which means that the centralized optimization method can not be achieved on this topology. To this end, we propose a Decentralized Periodic Averaging SGD (DPA-SGD) to tackle the optimization problem in decentralized topology.</p>
<hr>
<h2 id="approach">Approach</h2>
<h3 id="decentralized-periodic-averaging-sgd">Decentralized Periodic Averaging SGD</h3>
<p>As for decentralized topology, due to the disappearing of central node, same central averaging method can not be applied. In order to overcome this problem, we come up with a novel optimization method, Decentralized Periodic Averaging SGD (DPA-SGD). The main idea of DPA-SGD is that during the communication period $\tau$, local SGD is applied on each node respectively, and synchronizing all the parameters at every $\tau$ iterations amongst its connected neighbors. Due to this decentralized diverse connection, one global $\mathbf{\Omega}$ can not represent the individual correlation. So we propose to use a distinct covariance matrix $\mathbf{\Omega}_k$ to represent their own mutual relationship. We also come up with an effective way to update the different $\mathbf{\Omega}_k$. To be specific, consider one particular node $m$ and its neighbor connected nodes as set $\mathcal{M}$.</p>
<p>The new objective function can be defined as:</p>
<p>$$
\begin{aligned}
&amp; \begin{aligned} \min_{\mathbf{\theta}, \vec{U},\vec{W},\mathbf{\Omega}}
&amp;\sum_{k=1}^{K}\frac{1}{n_k}\bigg[\bigg.\sum_{i=1}^{n_k}l(f(\vec{x}_i^{k},\mathbf{\theta}_k,\vec{U}_k,\vec{w}_k),\vec{y}_i^k) \\<br>
&amp;+ \frac{1}{2}\lambda_ 1tr(\vec{W}_k\mathbf{\Omega}_k^{-1}\vec{W}_k^{T})\bigg]\bigg. + \frac{1}{2}\lambda_2||\vec{W}||_F^2\\<br>
&amp;+\frac{1}{2}\lambda_3||\mathbf{\theta}||_F^2 + \frac{1}{2}\lambda_4||\vec{U}||_F^2, \end{aligned} \\<br>
&amp; \quad \text{s.t.} \quad  \mathbf{\Omega}_k \ge 0 \quad \text{and} \quad tr(\mathbf{\Omega}_k) = 1, \quad k = 1, 2, &hellip; ,K.
\end{aligned}
$$</p>
<p>where $\vec{W}_k = (\vec{w}_1,\vec{w}_2,&hellip;,\vec{w}_m,&hellip;\vec{w}_{|\mathcal{M}|})\in\mathbb{R}^{d\times|\mathcal{M}|}$ is the parameters for $m$ and its neighbor tasks. The matrix $\mathbf{\Omega}_k\in\mathbb{R}^{|\mathcal{M}|\times{|\mathcal{M}|}}$ represents the correlation amongst nodes in set $\mathcal{M}$. Here in order to record the entire nodes connection in the network, we introduce a <em>node connection matrix</em> $\vec{M}\in\mathbb{R}^{K\times{K}}$ represents the neighbor relationships for each nodes, where $M_{i, j}$ is a value that indicates node $i$ and $j$ are connected as shown in Figure 3, where worker one is only connected with worker two and four. Note that, if $\vec{M} = \vec{I}$ (Identity matrix), then every nodes are independent and update the parameters respectively. If $\vec{M} = \vec{J}$ (one for each element), the model is degenerated into centralized model. We study the model performance under sparse matrix $\vec{M}$ and find that similar results can be achieved as a ring network topology, which each node is only connected with its nearby two nodes, as illustrated in Figure 3.</p>






  



  
  











<figure id="figure-decentralized-periodic-averaging-sgd">


  <a data-fancybox="" href="/project/dpa_sgd/images/decentralizedSGD_huba6fab2315ef5e6a14b9cf31294d583a_115107_2000x2000_fit_q75_lanczos.jpg" data-caption="Decentralized Periodic Averaging SGD">


  <img data-src="/project/dpa_sgd/images/decentralizedSGD_huba6fab2315ef5e6a14b9cf31294d583a_115107_2000x2000_fit_q75_lanczos.jpg" class="lazyload" alt="" width="961" height="454">
</a>


  
  
  <figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
    Decentralized Periodic Averaging SGD
  </figcaption>


</figure>

<p>To solve this non-convex problem, we apply the alternating optimization method  Zhang and Yeung [2012], where alternately updating parameters $\vec{X} = (\vec{W, U},\mathbf{\theta})$ and $\mathbf{\Omega}$.</p>
<p><em>Optimizing</em> $\mathbf{\theta}, \vec{W}$ and $\vec{U}$: For simplicity, we define set $\Xi = (\mathbf{\Omega}_1, \mathbf{\Omega}_2,&hellip;,\mathbf{\Omega_K})$ to represent the correlation matrix for every nodes. Fixing $\Xi$, we can use SGD method to update $\mathbf{\theta}, \vec{W}$ and $\vec{U}$ jointly. Our problem can then be reformulated as:</p>
<p>$$
\begin{aligned}
G(\vec{W}, \vec{U}, \mathbf{\theta}|\Xi) &amp;= \sum_{k=1}^{K}\frac{1}{n_k} \bigg[\bigg.
\sum_{i=1}^{n_k}l(f(\textbf{x}_i^{k},\mathbf{\theta}_k,\textbf{U}_k,\textbf{w}_k),\textbf{y}_i^k) \\<br>
&amp; + \frac{1}{2} \lambda_1tr(\textbf{W}_k\mathbf{\Omega}_k^{-1}\textbf{W}_k^{T})
\bigg]\bigg. + \frac{1}{2}\lambda_2||\textbf{W}||_F^2 \\<br>
&amp;+ \frac{1}{2}\lambda_3||\mathbf{\theta}||_F^2 + \frac{1}{2}\lambda_4||\textbf{U}||_F^2
\end{aligned}
$$</p>
<p>We can calculate the gradient of $\vec{W}$, $\vec{U}$ and $\mathbf{\theta}$ respectively. Let $L = \sum_{k=1}^{K}\frac{1}{n_k}\sum_{i=1}^{n_k}l(f(\mathbf{x}_i^{k}, \mathbf{\theta}_k,\mathbf{u}_k,\mathbf{w}_k),\mathbf{y}_i^k)$. Then the gradient formulations for each node are:</p>
<p>$$
\frac{\partial{G(\vec{W}, \vec{U}, \mathbf{\theta}|\Xi)}}{\partial{\vec{w}_k}} =
\frac{\partial{L}}{\partial{\vec{w}_k}} +
\lambda_1\sum_{i=1}^{\mathcal{|M|}} \frac{1}{n_i}{\vec{w}_k}\mathbf{\Omega}_i^{-1} +
\lambda_2\vec{w}_k
$$</p>
<p>where the summation is amongst all the nodes connected to node $k$,</p>
<p>$$
\frac{\partial{G(\vec{W}, \vec{U}, \mathbf{\theta}|\Xi)}}{\partial \mathbf{\theta}_k} = \frac{\partial{L}}{\partial\mathbf{\theta}_k} + \lambda_3\mathbf{\theta}_k,
$$</p>
<p>$$
\frac{\partial{G(\vec{W}, \vec{U}, \mathbf{\theta}|\Xi)}}{\partial{\vec{u}_k}} = \frac{\partial{L}}{\partial{\vec{u}_k}} + \lambda_4\vec{u}_k
$$</p>
<p><em>Optimizing</em> $\Xi$: In paper Zhang and Yeung [2012], an analytical solution form is given for $\mathbf{\Omega}$:</p>
<p>$$
\mathbf{\Omega} = \frac{(\vec{W}^T\vec{W})^\frac{1}{2}}{tr((\vec{W}^T\vec{W})^{\frac{1}{2}})}
$$</p>
<p>Apparently, if $\mathbf{w}_i$ and $\mathbf{w}_j$ are close to each other, $\mathbf{\Omega}$ will be large. However, the missing central node forbidding to average parameters globally. So here we propose a novel way to update each $\mathbf{\Omega}_k\in\Xi$:</p>
<p>$$
\mathbf{\Omega}_{t+1}^{(k)} \leftarrow \eta\frac{1}{|\mathcal{M}|}({\sum_{i=1}^{|\mathcal{M}|}}\frac{1}{n_i}\mathbf{\Omega}_{t}^{(i)} + \frac{(\vec{W}_k^T\vec{W}_k)^\frac{1}{2}}{tr((\vec{W}_k^T\vec{W}_k)^{\frac{1}{2}})})
$$</p>
<p>The first averaging term can incorporate the nearby nodes correlation into its own and the second term captures the new correlation between its neighbors as shown in Figure 3.</p>
<h3 id="algorithm">Algorithm</h3>
<p>In general, the algorithm of DPA-SGD can be summarized as: while in local update period, each node calculates the gradient $g(\vec{X}_t^{(i)})$ based on one mini-batch of data and then update $\vec{X}^{(i)}$; For every synchronization per $\tau$ update, the novel update way of $\mathbf{\Omega}$ is conducted.</p>






  



  
  











<figure id="figure-algorithm-1-federated-multi-task-deep-learning-framework-with-decentralized-averaging-sgd">


  <a data-fancybox="" href="/project/dpa_sgd/images/algorithm1_huebfc1ec7eb44c05c128ffe140125722d_379297_2000x2000_fit_lanczos_2.png" data-caption="&lt;strong&gt;Algorithm 1&lt;/strong&gt;: Federated Multi-Task Deep Learning Framework with Decentralized Averaging SGD">


  <img data-src="/project/dpa_sgd/images/algorithm1_huebfc1ec7eb44c05c128ffe140125722d_379297_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="2508" height="1684">
</a>


  
  
  <figcaption>
    <strong>Algorithm 1</strong>: Federated Multi-Task Deep Learning Framework with Decentralized Averaging SGD
  </figcaption>


</figure>

<h3 id="advantages-of-our-algorithm">Advantages of Our Algorithm</h3>
<p>Here we illustrate system-wise advantages of DPA-SGD:</p>






  



  
  











<figure id="figure-illustration-of-training-time-reducing-due-to-the-mechanism-of-dpa-sgd">


  <a data-fancybox="" href="/project/dpa_sgd/images/advantage_huca52a4d98cc084a2f136be1565963362_287468_2000x2000_fit_lanczos_2.png" data-caption="Illustration of training time reducing due to the mechanism of DPA-SGD">


  <img data-src="/project/dpa_sgd/images/advantage_huca52a4d98cc084a2f136be1565963362_287468_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="2184" height="1684">
</a>


  
  
  <figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
    Illustration of training time reducing due to the mechanism of DPA-SGD
  </figcaption>


</figure>

<p><strong>Faster convergence speed</strong>. Figure 4 illustrates three reasons that DHA-SGD can speed up convergence.</p>
<ol>
<li><em>Periodic averaging</em> can alleviate the communication delay by reducing times of synchronization which only happen periodically. As we can see in Figure 4, the yellow blocks (communication) will largely be deleted due to the periodic averaging mechanism.</li>
<li>This idle time can also be significantly reduced through periodic averaging as shown in Figure 4.</li>
<li>In the decentralized topology, because a worker only needs to exchange gradients with its neighbors, another worker with slow computation and communication will not interrupt its iteration. For example, worker 2 in the above figure can synchronize earlier without waiting for worker 4. Thus, DHA-SGD can largely reduce convergence time.</li>
</ol>
<p><strong>Fewer communication rounds</strong>. The periodic averaging strategy can reduce the number of communication rounds. Although our work focuses on optimizing the ratio of computation and communication rather than improving the communication cost for each iteration, gradient compression method (Deep Gradient Compression [Lin <em>et al.</em>, 2017]) for each iteration can directly extendable to to our algorithm in a practical system.</p>
<h3 id="system-design">System Design</h3>






  



  
  











<figure id="figure-federated-learning-system-design-and-protocol">


  <a data-fancybox="" href="/project/dpa_sgd/images/system1_hu83de1cf0503563fdaf62e3d336a68002_546718_2000x2000_fit_lanczos_2.png" data-caption="Federated Learning System Design and Protocol">


  <img data-src="/project/dpa_sgd/images/system1_hu83de1cf0503563fdaf62e3d336a68002_546718_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="1536" height="1380">
</a>


  
  
  <figcaption data-pre="Figure&nbsp;" data-post=":&nbsp;" class="numbered">
    Federated Learning System Design and Protocol
  </figcaption>


</figure>

<p>We have developed a real-world decentralized federated learning system. Our system is currently deployed in a cluster environment, consisting of 24 physical machines, each supporting 48 CPU cores. Suppose we run one process per CPU core, this system can run up to 1152 workers for parallel training. Our federated learning system enables centralized and decentralization training while supporting the Federated multi-task learning framework. It also supports user and training management in the Federated Learning scenario. As shown in Figure 5 (Upper), it includes training process management such as topology generation, user selection, configuration dispatching, on-device training, and statistics collection. In the topological generation step, we can select the appropriate eigenvalues for the topology matrix according to our the convergence property analysis, which determines the sparseness of the network topology to balance the model accuracy and the training speed. The user selection process can configure different strategies to select distinct users. Each user only requires training once for a model. In our experiment, users are selected according to the LEAF data set. This process can be further optimized in the future to choose users who are more meaningful to the model.</p>
<p>The software architecture of each worker is shown in Figure 5 (Lower). Each work can be an IoT device, smartphone or the edge server.  It is an abstract architecture design for the on-device software system which unifies the system architecture for different on-device operating systems such as Android or iOS for the smartphone and the linux edge server. For the edge server, we implement this system design in a Python environment. For the smartphone, we develop the training worker system based on Android and iOS. The low-level communication is an abstract layer. In the edge server environment, we use the MPI protocol for exchanging gradient or other necessary information. As we can see, the communication sending and receiving threads are independent of the training threads. The collaborate through message queues. Currently, we only disclose the implementation of the MPI communication protocol in the source code. In the future, we consider open source our code to support more on-device platforms.</p>
<p>To put it simply, another contribution of this paper is that we publish a practical federated learning system that can promote further research on distributed learning and especially federated learning.</p>
<h2 id="comparison-to-previous-works">Comparison to Previous Works</h2>
<h3 id="federated-multi-task-learning">Federated Multi-Task Learning</h3>
<p>Early examples of research into federated learning. To address both statistical and system challenges, [Smith <em>et al.</em>, 2017] and [Caldas <em>et al</em>. 2018] propose a multi-task learning framework for federated learning and its related optimization algorithm, which extends early works from distributed machine learning, including SDCAShalev-Shwartz and Zhang [2013]; Yang [2013]; Yang <em>et al.</em> [2013] and COCOAJaggi <em>et al.</em> [2014]; Ma <em>et al.</em> [2015]; Smith <em>et al.</em> [2016]. The main limitation of Smith <em>et al.</em> [2017] and Caldas <em>et al.</em> [2018], however, is that <strong>strong duality is only guaranteed when the objective function is convex, which can not be generalized to the non-convex setting, especially deep neural networks</strong>.</p>
<p>Another line of work related to federated multi-task learning is the cloud-based distributed multi-task learning [Ahmed <em>et al.</em>, 2014; Jin <em>et al.</em>, 2015; Mateos-Núñez <em>et al.</em>, 2015; Wang <em>et al.</em>, 2016; Baytas <em>et al.</em>, 2016; Liu <em>et al.</em>, 2017]. However, <strong>their assumption that the same amount of work is done locally on each node is prohibitive in federated settings</strong>, and none of these works take into account the systems challenges that arise in the federated setting.</p>
<p>In our work, we focus on training the deep learning model in the federated setting. To be more specific, <strong>in this work we further extend previous works to a generic multi-task deep learning framework and a more efficient optimization method. Different from previous works, we propose a decentralized approach for federated learning</strong>.</p>
<h3 id="stochastic-gradient-decent-optimization">Stochastic Gradient Decent Optimization</h3>
<p>In large scale distributed deep learning, to address the communication bottleneck, synchronized mini-batch SGD, which increase the computation to communication ratio, is widely used in the parameter server framework [Dean <em>et al.</em>; Li <em>et al.</em>, 2014; Cui <em>et al.</em>, 2014] and popular deep learning systems such as Tensorflow [Abadi <em>et al.</em>, 2016] and PyTorch [Paszke <em>et al.</em>, 2017].</p>
<p>Compared to this synchronized mini-batch SGD, Federated Averaging(FedAvg) SGD [Koneˇcný <em>et al.</em>, 2016] in the federated setting empirically shows it has less communication rounds and it is also robust to non-IID data, which is now the state-of-the-art SGD algorithm for federated learning.</p>
<p>Decentralized SGD, another approach to reducing communication, was successfully applied to deep learning [Jin <em>et al.</em>, 2016; Jiang <em>et al.</em>, 2017; Lian <em>et al.</em>, 2017]. Instead of synchronizing with all workers, a worker in the decentralized SGD framework only needs to exchange gradient with its neighbors. Therefore, this sparse-connected topology can reduce the overall communication per iteration.</p>
<p><strong>Our work aims to design a novel SGD algorithm for our multi-task deep learning framework</strong>, which <strong>can leverage the advantages of periodic averaging SGD and decentralized SGD</strong>. We called it as Decentralized Periodic Averaging SGD. Although recent work [Wang and Joshi, 2018] has this idea preliminarily, it does not provide adequate theoretical analysis and empirical evaluation in the federated setting.</p>
<h2 id="results">Results</h2>
<div style="overflow: auto;"><table id="leafdata-table"><tr><th><span style="font-weight:bold">Dataset</span></th><th><span style="font-weight:bold">Number of devices</span></th><th><span style="font-weight:bold">Total samples</span></th><th colspan="2"><span style="font-weight:bold">Sample per device</span></th></tr><tr><td></td><td></td><td></td><td>mean</td><td>stdev</td></tr><tr><td>FEMNIST</td><td>3,550</td><td>805,263</td><td>226.83</td><td>88.94</td></tr><tr><td>Sent140</td><td>660,120</td><td>1, 600, 498</td><td>2.42</td><td>4.71</td></tr><tr><td>Shakespeare</td><td>2,288</td><td>106, 126</td><td>46.38</td><td>91.71</td></tr></table></div>
<p>This table is a brief statistic of the dataset (LEAF) that we are using in the experiments. To be specific, FEMNIST is a handwritten digit database, where image classification problem can be conducted based on this dataset. Sent140 is a text dataset, which allows you to discover the sentiment of a brand or product. Shakespeare is also a text dataset, however the objective here is try to learn the pattern of the sentences and generate similar text style.</p>






  



  
  











<figure id="figure-accuracy-for-fedavg-single-task-and-ring-dpa-sgd-multi-task-vs-round-number">


  <a data-fancybox="" href="/project/dpa_sgd/images/results/acc2-round_number_hu1b1935e33a88baa3b47754e16403a12d_48889_2000x2000_fit_lanczos_2.png" data-caption="Accuracy for FedAvg Single-task and Ring DPA-SGD Multi-task vs Round number">


  <img data-src="/project/dpa_sgd/images/results/acc2-round_number_hu1b1935e33a88baa3b47754e16403a12d_48889_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="624" height="520">
</a>


  
  
  <figcaption>
    Accuracy for FedAvg Single-task and Ring DPA-SGD Multi-task vs Round number
  </figcaption>


</figure>

<p>We compare the performance between FedAvg, the current state-of-the-art Federated Learning algorithm, and our DPA-SGD on Multi-Task Learning Framework (DPA-SGD-MTL) with a ring topology network. From the Figure, we clearly see that the training speed is around 20% faster than the FedAvg. The Ring DPA-SGD-MTL’s accuracy is also comparable to the FedAvg.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">





  



  
  











<figure id="figure-accuracy-for-fedavg-mtl-and-dpa-sgd-mtl-vs-walk-clock-time">


  <a data-fancybox="" href="/project/dpa_sgd/images/results/acc1-time_huf55eceac0cc195dd4c9e2c46301c67c2_47880_2000x2000_fit_lanczos_2.png" data-caption="Accuracy for FedAvg-MTL and DPA-SGD MTL vs walk clock time">


  <img data-src="/project/dpa_sgd/images/results/acc1-time_huf55eceac0cc195dd4c9e2c46301c67c2_47880_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="634" height="503">
</a>


  
  
  <figcaption>
    Accuracy for FedAvg-MTL and DPA-SGD MTL vs walk clock time
  </figcaption>


</figure>
</td>
<td style="text-align:center">





  



  
  











<figure id="figure-accuracy-for-fedavg-mtl-and-dpa-sgd-mtl-vs-round-number">


  <a data-fancybox="" href="/project/dpa_sgd/images/results/acc1-round_number_hubf99043acb542c03ffabbe3bd8a40698_46387_2000x2000_fit_lanczos_2.png" data-caption="Accuracy for FedAvg-MTL and DPA-SGD MTL vs round number">


  <img data-src="/project/dpa_sgd/images/results/acc1-round_number_hubf99043acb542c03ffabbe3bd8a40698_46387_2000x2000_fit_lanczos_2.png" class="lazyload" alt="" width="662" height="503">
</a>


  
  
  <figcaption>
    Accuracy for FedAvg-MTL and DPA-SGD MTL vs round number
  </figcaption>


</figure>
</td>
</tr>
</tbody>
</table>
<p>We also compared the performance between FedAvg on Multi-Task Learning Framework (FedAvg-MTL) and our DPA-SGD on Multi-Task Learning Framework (Ring DPA-SGD-MTL) with a ring topology network. From the Figure, we clearly see that the training speed is around 20% faster than the FedAvg-MTL. The Ring DPA-SGD-MTL’s accuracy is slightly lower but comparable than the FedAvg-MTL . This proves that our convergence analysis that when decentralized the topology of the gradient exchanging, due to the sparsity of the topology has a negative impact on the convergence of the model. We have to balance the performance of the model and the training speed in the federated learning setting.</p>
<p>We will conduct more experiment on model performance and training speed on communication and computation heterogeneous setting (delay = 0ms, 300ms, 1s, 3s), different number of works (4, 8, 16, 32, 64, 128, 256, 512), and different topologies (0.3, 0.6, 0.9). Hopefully, we can finish these experiments before the NeurIPS deadline.</p>
<h2 id="appendix">Appendix</h2>
<h3 id="appendix-i-convergence-analysis">Appendix I: Convergence Analysis</h3>
<p><strong>Convergence of DPA-SGD</strong>: If the communication period $\tau$ satisfies:</p>
<p>$$
T \geq K^{3} \left( \frac{1+\zeta^{2}}{1-\zeta^{2}} \tau - 1 \right)^{2}
$$</p>
<p>then with learning rate $\eta = \frac{K}{LK} \sqrt{\frac{K}{T}}$ , the average-squared gradient norm after K iterations is bounded by</p>
<p>$$
\mathbb{E} \Bigg[ \frac{1}{T} \sum\limits_{t=1}^T {\left\lVert \nabla F(\vec u_{t}) \right\rVert}^{2} \Bigg] \leq \frac{2[F(\vec{x}_{1})-F_{inf}]}{\eta T} + \frac{2\sigma^{2}}{\sqrt{KT}} \
= \mathcal{O}(\frac{1}{\sqrt{KT}})
$$</p>
<p><strong>How to choose $\tau$, $\zeta$</strong>: for a small number of well-connected workers, larger $\tau$ is more preferable; for a large number of workers, using a sparse mixing matrix and small $\tau$ gives
better convergence.</p>
<p><strong>Effect of Extreme Large $K$</strong>: the iteration number T will be extreme large. To guaran-tee the convergence, try to reduce the worker number through system-wised optimization:</p>
<ol>
<li>Streaming training</li>
<li>upload on-device data to the edge data center.</li>
</ol>
<h3 id="appendix-ii-poster">Appendix II: Poster</h3>
<figure><a href="attachments/fl-dpa-sgd-poster.pdf"><img src="images/fl-dpa-sgd-poster.png"></a><figcaption>Poster (click to see the pdf)</figcaption></figure>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/machine-learning/">Machine Learning</a>
  
  <a class="badge badge-light" href="/tag/federated-learning/">Federated Learning</a>
  
  <a class="badge badge-light" href="/tag/multi-task-learning/">Multi-task Learning</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://www.zijianhu.com/project/dpa_sgd/&amp;text=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://www.zijianhu.com/project/dpa_sgd/&amp;t=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design&amp;body=https://www.zijianhu.com/project/dpa_sgd/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://www.zijianhu.com/project/dpa_sgd/&amp;title=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design%20https://www.zijianhu.com/project/dpa_sgd/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://www.zijianhu.com/project/dpa_sgd/&amp;title=Decentralized%20Federated%20Multi-Task%20Learning%20and%20System%20Design" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    




  
    




  
    




  
    



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://www.zijianhu.com/"><img class="avatar mr-3 avatar-circle" src="/author/zijian-hu/avatar_hue0cac3a7eec4b2f4e542a56f80fe66f9_332642_270x270_fill_q75_lanczos_center.jpg" alt="Zijian Hu"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://www.zijianhu.com/">Zijian Hu</a></h5>
      <h6 class="card-subtitle">Research Assistant</h6>
      <p class="card-text">My research interests include computer vision, machine learning, and robotics.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/zijianhu" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/zijianhu/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=jQ9GwCoAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Zijian_Hu3" target="_blank" rel="noopener">
        <i class="ai ai-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/zijian-hu" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://drive.google.com/file/d/1oAOGkY2FmW6SOBPwkvSkb-ANSilb6Smv/view?usp=sharing" target="_blank" rel="noopener">
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
    




  














  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/publication/hu-2020-simple/">SimPLE: Similar Pseudo Label Exploitation for Semi-Supervised Classification</a></li>
      
      <li><a href="/project/lwll/">Learning with Less Labeling (LwLL)</a></li>
      
      <li><a href="/post/pytorch/ema/">PyTorch: Exponential Moving Average (EMA) Example</a></li>
      
      <li><a href="/project/multi_party/">Trust in Multi-Party Human-Robot Interaction</a></li>
      
    </ul>
  </div>
  





    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.ca606e186e454568cb2c38dc46dfab45.js"></script>

    






</body>
</html>
